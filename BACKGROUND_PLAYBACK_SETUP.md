# バックグラウンド再生セットアップガイド

## ✅ 完了した設定

以下の設定はすでに完了しています：

1. ✅ `expo-av` パッケージのインストール
2. ✅ `expo-dev-client` パッケージのインストール
3. ✅ `app.json` にバックグラウンドオーディオ設定を追加
4. ✅ `app/_layout.tsx` にオーディオモード設定を追加
5. ✅ `eas.json` の作成

---

## 🚀 次のステップ：Dev Client ビルド

### 前提条件

- Apple Developer アカウント（無料アカウントでもOK）
- Expo アカウント（無料）

---

## ステップ1: EAS CLI のインストール（初回のみ）

```bash
npm install -g eas-cli
```

---

## ステップ2: Expo にログイン

```bash
eas login
```

ブラウザが開くので、Expo アカウントでログインしてください。
アカウントがない場合は作成してください（無料）。

---

## ステップ3: プロジェクトの初期化（初回のみ）

```bash
# プロジェクトディレクトリで実行
cd /Users/daisuke/Desktop/project/開発アイデア/🔥自分用ポッドキャストアプリ/TextCastApp

# EAS プロジェクトとして初期化
eas build:configure
```

---

## ステップ4: Dev Client をビルド

### iOS シミュレータ用（Macのみ）

```bash
eas build --profile development --platform ios
```

**所要時間**: 15-30分（クラウドでビルド）

ビルド中はターミナルを閉じても大丈夫です。
進捗は https://expo.dev でも確認できます。

---

## ステップ5: ビルドが完了したら

### A. iOSシミュレータの場合

1. ビルド完了後に表示されるURLをクリック
2. `.tar.gz` ファイルをダウンロード
3. 解凍して `.app` ファイルを取得
4. シミュレータにドラッグ&ドロップ

### B. 実機の場合

1. ビルド完了後にQRコードが表示される
2. iPhoneのカメラでQRコードをスキャン
3. TestFlight または直接インストール

---

## ステップ6: Dev Client で開発

### 開発サーバーを起動

```bash
npx expo start --dev-client
```

### Dev Client アプリを開く

1. インストールした Dev Client アプリを起動
2. 表示されるメニューから以下のいずれか：
   - QRコードをスキャン
   - "Enter URL manually" → 表示されるURLを入力

### バックグラウンド再生をテスト

1. アプリで音声再生を開始
2. ホームボタンを押す（またはスワイプ）
3. **✅ バックグラウンドで再生が継続される！**

---

## 🎯 よくある質問

### Q1: Expo Go では動きませんか？

**A**: はい、バックグラウンド再生は**Dev Client または実機ビルドでのみ動作**します。
Expo Go は制限があるため動作しません。

---

### Q2: ビルドに時間がかかりすぎる

**A**: 初回ビルドは15-30分かかりますが、**1回だけ**です。
コーヒーを飲んで待ちましょう☕

---

### Q3: ビルド中にエラーが出た

**A**: 以下を確認してください：

- Apple Developer アカウントにログインしているか
- `eas login` で Expo にログインしているか
- インターネット接続は安定しているか

エラーメッセージをコピーして、再度実行するか、サポートに問い合わせてください。

---

### Q4: コードを変更したら再ビルド必要？

**A**: **ほとんどの場合、不要です！**

再ビルドが必要な場合：
- ✅ 新しいネイティブパッケージを追加した時
- ✅ `app.json` の設定を変更した時
- ✅ ネイティブコードを変更した時

再ビルド不要な場合：
- ❌ JavaScript/TypeScriptコードの変更（Fast Refreshで即座に反映）
- ❌ UI/UXの変更
- ❌ ロジックの変更

---

### Q5: Dev Client と本番ビルドの違いは？

**A**:

| 項目 | Dev Client | 本番ビルド |
|------|-----------|-----------|
| 用途 | 開発・デバッグ | App Store配布 |
| Fast Refresh | ✅ 有効 | ❌ 無効 |
| デバッグツール | ✅ 有効 | ❌ 無効 |
| サイズ | 大きい | 最適化済み |
| 配布 | 自分だけ | 一般ユーザー |

---

## 🔧 トラブルシューティング

### Expo Goで起動できなくなった

```bash
# Expo Goでも起動したい場合
npx expo start --tunnel

# Dev Clientで起動したい場合
npx expo start --dev-client
```

両方を切り替えて使用できます。

---

### ビルドがキューに入ったまま動かない

無料アカウントの場合、同時ビルド数に制限があります。
他のビルドが完了するまで待つか、有料プランにアップグレードしてください。

---

## 📱 次のステップ：本番リリース

Dev Client でテストが完了したら、本番ビルドを作成します：

```bash
# 本番用ビルド
eas build --profile production --platform ios

# App Store に提出
eas submit --platform ios
```

---

## 🎉 完了！

これでバックグラウンド再生が実装されました！

ビルドが完了したら、必ずテストしてください：

1. ✅ 音声再生開始
2. ✅ ホーム画面に戻る
3. ✅ バックグラウンドで再生継続
4. ✅ ロック画面でもコントロール可能

---

## 📞 サポート

問題が発生した場合：

1. エラーメッセージをコピー
2. https://expo.dev のビルドログを確認
3. Expo Discord または GitHub Issues で質問

頑張ってください！ 🚀
